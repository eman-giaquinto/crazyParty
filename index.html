<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Festa nella Palude di Shrek</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
</head>
<body>

    <header>
        <h1>Festa nella Palude!</h1>
        <p>Assegna i tuoi amici ai personaggi (anche solo alcuni!)</p>
    </header>

    <div class="container">
        
        <div class="card">
            <div class="img-container"><img src="img/shrek.png" alt="Shrek"></div>
            <h3>Shrek</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/fiona.png" alt="Fiona"></div>
            <h3>Fiona</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/ciuchino.png" alt="Ciuchino"></div>
            <h3>Ciuchino</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/gatto.png" alt="Gatto"></div>
            <h3>Gatto</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>
        
        <div class="card">
            <div class="img-container"><img src="img/zenzy.png" alt="Zenzy"></div>
            <h3>Zenzy</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/farquaad.png" alt="Lord Farquaad"></div>
            <h3>Lord Farquaad</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/pinocchio.png" alt="Pinocchio"></div>
            <h3>Pinocchio</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/drago.png" alt="Draghessa"></div>
            <h3>Draghessa</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/lupo.png" alt="Lupo Cattivo"></div>
            <h3>Lupo Cattivo</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

        <div class="card">
            <div class="img-container"><img src="img/porcellini.png" alt="Tre Porcellini"></div>
            <h3>I 3 Porcellini</h3>
            <input type="text" class="guest-input" placeholder="Nome invitato...">
            <div class="actions">
                <button class="btn btn-confirm" onclick="confermaInvitato(this)">✔</button>
                <button class="btn btn-remove hidden" onclick="rimuoviInvitato(this)">✖</button>
            </div>
        </div>

    </div>

    <div class="footer-action">
        <button id="btn-finale" onclick="vaiAllaProssimaPagina()">Conferma e vai alla festa ➜</button>
    </div>

<script>
        // Tasto VERDE (Conferma)
        function confermaInvitato(btn) {
            const card = btn.closest('.card');
            const input = card.querySelector('.guest-input');
            const removeBtn = card.querySelector('.btn-remove');

            if (input.value.trim() === "") {
                alert("Scrivi un nome prima di confermare questo personaggio!");
                return;
            }

            input.disabled = true;
            input.classList.add('confirmed');
            btn.classList.add('hidden');
            removeBtn.classList.remove('hidden');
        }

        // Tasto ROSSO (Rimuovi)
        function rimuoviInvitato(btn) {
            const card = btn.closest('.card');
            const input = card.querySelector('.guest-input');
            const confirmBtn = card.querySelector('.btn-confirm');

            input.disabled = false;
            input.value = "";
            input.classList.remove('confirmed');
            btn.classList.add('hidden');
            confirmBtn.classList.remove('hidden');
        }

        // Tasto FINALE
        function vaiAllaProssimaPagina() {
            // 1. Raccogliamo i dati (Questa parte mancava nel tuo codice!)
            const cards = document.querySelectorAll('.card');
            let listaInvitati = [];

            cards.forEach(card => {
                const input = card.querySelector('.guest-input');
                const nomePersonaggio = card.querySelector('h3').innerText;
                
                // Se l'input è confermato (verde) e non è vuoto
                if (input.classList.contains('confirmed') && input.value.trim() !== "") {
                    listaInvitati.push({
                        personaggio: nomePersonaggio,
                        ospite: input.value
                    });
                }
            });

            // 2. Controllo se la lista è vuota
            if (listaInvitati.length === 0) {
                const sicuro = confirm("Non hai assegnato nessun invitato. Vuoi procedere comunque?");
                if (!sicuro) return;
            }

            // 3. Salviamo la lista nella memoria del browser
            localStorage.setItem('listaFestaShrek', JSON.stringify(listaInvitati));

            // 4. Reindirizzamento CORRETTO alla cartella pages
            window.location.href = "pages/resoconto.html"; 
        }
    </script>
    
</body>
</html>


